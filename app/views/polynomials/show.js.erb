$("#diffeq").html("<%= escape_javascript(image_tag('spinner.gif')) %>");
$("#receq").html("<%= escape_javascript(image_tag('spinner.gif')) %>");

var compute = function(){
  var error_message = "An error occurred!<br/>Either no connection to the CAS server could be established or your choice of parameters fails!<br/>Try it with other parameters!";
  
  // compute difference/differential equation
  $.ajax({
    url: "<%= compute_polynomial_path(@polynomial.sid, :type => {:diffeq => true}, :parameters => params) %>",
    success: function(data) {
      var input = data.split("---")[0];
      var output = data.split("---")[1];
      $("#diffeq_wrapper").animate({
        opacity: 1.0,
        width: '100%'
      }, 1000, function(){
        $("#diffeq").html('\\[' + output + '\\]');        
        $("#diffeq_computation").html(input);        
        MathJax.Hub.Typeset();  
      });
    }, 
	error: function(data) {
	  $("#diffeq").html(error_message);        
	}
  });    
  
  // compute recurrence equation
  $.ajax({
    url: "<%= compute_polynomial_path(@polynomial.sid, :type => {:receq => true}, :parameters => params) %>",
    success: function(data) {
      var input = data.split("---")[0];
      var output = data.split("---")[1];
      $("#receq_wrapper").animate({
        opacity: 1.0,
        width: '100%'
      }, 1000, function(){
        $("#receq").html('\\[' + output + '\\]');  
        $("#receq_computation").html(input);                  
        MathJax.Hub.Typeset();  
      });
    }, 
    error: function(data) {
      $("#receq").html(error_message);        
    }
  });  
};

compute();